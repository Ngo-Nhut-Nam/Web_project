<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hệ Thống Thi Trực Tuyến</title>

</head>
    <link rel="stylesheet" href="css/index2.css">
<body>
    <!-- Header -->
    <header>
        <div class="header-container">
            <div class="logo">ThiTrựcTuyến.vn</div>
            <nav>
                <ul>
                    <li><a href="main_page2.html">Trang chủ</a></li>
                    <li><a href="#" onclick="showPage('exam-list')">Danh sách đề thi</a></li>
                    <li><a href="result.html">Kết quả</a></li>
                </ul>
            </nav>
            <div class="auth-buttons">
                <a class="btn btn-profie" href="profile.html">Trang cá nhân</a>
            </div>
        </div>

    </header>

    <!-- Main Content - Các trang sẽ hiển thị ở đây -->
    <main>

        <!-- Trang danh sách đề thi -->
        <section id="exam-list" class="page">
            <div class="exams-header">
                <h2>Danh sách đề thi</h2>
                <div class="exams-controls">
                    <select class="exams-list" id="subject-filter">
                        <option value="all">Tất cả môn</option>
                        <option value="math">Toán học</option>
                        <option value="physics">Vật lý</option>
                        <option value="chemistry">Hóa học</option>
                        <option value="english">Tiếng Anh</option>
                    </select>
                    <button class="btn btn-primary" onclick="showPage('add-exam')">
                        <i class="fas fa-plus"></i> Thêm đề thi mới
                    </button>
                </div>
            </div>
            
            <div class="exams-grid">
                <div class="exam-card">
                    <div class="exam-header">
                        <h3>Toán học - Giữa kỳ 1</h3>
                    </div>
                    <div class="exam-body">
                        <div class="exam-info">
                            <span>Số câu:</span>
                            <span>40 câu</span>
                        </div>
                        <div class="exam-info">
                            <span>Thời gian:</span>
                            <span>60 phút</span>
                        </div>
                        <div class="exam-info">
                            <span>Độ khó:</span>
                            <span>Trung bình</span>
                        </div>
                    </div>
                    <div class="exam-footer">
                        <button class="btn btn-primary" onclick="startExam('math')">Bắt đầu thi</button>
                        <button class="btn btn-secondary" onclick="editExam('math')">Sửa</button>
                        <button class="btn btn-danger" onclick="deleteExam('math')">Xóa</button>
                    </div>
                </div>
                
                <div class="exam-card">
                    <div class="exam-header">
                        <h3>Vật lý - Chương 1</h3>
                    </div>
                    <div class="exam-body">
                        <div class="exam-info">
                            <span>Số câu:</span>
                            <span>30 câu</span>
                        </div>
                        <div class="exam-info">
                            <span>Thời gian:</span>
                            <span>45 phút</span>
                        </div>
                        <div class="exam-info">
                            <span>Độ khó:</span>
                            <span>Khó</span>
                        </div>
                    </div>
                    <div class="exam-footer">
                        <button class="btn btn-primary" onclick="startExam('physics')">Bắt đầu thi</button>
                        <button class="btn btn-secondary" onclick="editExam('math')">Sửa</button>
                        <button class="btn btn-danger" onclick="deleteExam('math')">Xóa</button>
                    </div>
                </div>
                
                <div class="exam-card">
                    <div class="exam-header">
                        <h3>Tiếng Anh - Bài kiểm tra 1</h3>
                    </div>
                    <div class="exam-body">
                        <div class="exam-info">
                            <span>Số câu:</span>
                            <span>50 câu</span>
                        </div>
                        <div class="exam-info">
                            <span>Thời gian:</span>
                            <span>75 phút</span>
                        </div>
                        <div class="exam-info">
                            <span>Độ khó:</span>
                            <span>Dễ</span>
                        </div>
                    </div>
                    <div class="exam-footer">
                        <button class="btn btn-primary" onclick="startExam('english')">Bắt đầu thi</button>
                        <button class="btn btn-secondary" onclick="editExam('math')">Sửa</button>
                        <button class="btn btn-danger" onclick="deleteExam('math')">Xóa</button>
                    </div>
                </div>
            </div>
        </section>

         <!-- Trang thêm đề thi mới-->
        <section id="add-exam" class="page">
            <div class="add-exam-container">
                <h2 class="exam-title">Thêm đề thi mới</h2>
                <form id="add-exam-form">
                    <div class="form-group">
                        <label for="add-exam-title">Tiêu đề đề thi</label>
                        <input type="text" id="add-exam-title" name="title" placeholder="Nhập tiêu đề đề thi" required>
                    </div>
                    <div class="form-group">
                        <label for="add-exam-subject">Môn học</label>
                        <select id="add-exam-subject" name="subject" required>
                            <option value="math">Toán học</option>
                            <option value="physics">Vật lý</option>
                            <option value="chemistry">Hóa học</option>
                            <option value="english">Tiếng Anh</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="add-exam-questions">Số câu hỏi</label>
                        <input type="number" id="add-exam-questions" name="questions" placeholder="Nhập số câu hỏi" min="1" required>
                    </div>
                    <div class="form-group">
                        <label for="add-exam-time">Thời gian làm bài (phút)</label>
                        <input type="number" id="add-exam-time" name="time" placeholder="Nhập thời gian làm bài" min="1" required>
                    </div>
                    <div class="form-group">
                        <label for="add-exam-difficulty">Độ khó</label>
                        <select id="add-exam-difficulty" name="difficulty" required>
                            <option value="easy">Dễ</option>
                            <option value="medium">Trung bình</option>
                            <option value="hard">Khó</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="add-exam-description">Mô tả</label>
                        <textarea id="add-exam-description" name="description" placeholder="Nhập mô tả đề thi" rows="3"></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">Thêm đề thi</button>
                        <button type="button" class="btn btn-secondary" onclick="showPage('exam-list')">Quay lại</button>
                    </div>
                </form>
            </div>
        </section>

        <!-- Trang sửa đề thi -->
        <section id="edit-exam" class="page">
            <div class="edit-exam-container">
                <h2 class="exam-title">Sửa đề thi</h2>
                <form id="edit-exam-form">
                    <div class="form-group">
                        <label for="edit-exam-title">Tiêu đề đề thi</label>
                        <input type="text" id="edit-exam-title" name="title" placeholder="Nhập tiêu đề đề thi" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-exam-subject">Môn học</label>
                        <select id="edit-exam-subject" name="subject" required>
                            <option value="math">Toán học</option>
                            <option value="physics">Vật lý</option>
                            <option value="chemistry">Hóa học</option>
                            <option value="english">Tiếng Anh</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="edit-exam-questions">Số câu hỏi</label>
                        <input type="number" id="edit-exam-questions" name="questions" placeholder="Nhập số câu hỏi" min="1" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-exam-time">Thời gian làm bài (phút)</label>
                        <input type="number" id="edit-exam-time" name="time" placeholder="Nhập thời gian làm bài" min="1" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-exam-difficulty">Độ khó</label>
                        <select id="edit-exam-difficulty" name="difficulty" required>
                            <option value="easy">Dễ</option>
                            <option value="medium">Trung bình</option>
                            <option value="hard">Khó</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="edit-exam-description">Mô tả</label>
                        <textarea id="edit-exam-description" name="description" placeholder="Nhập mô tả đề thi" rows="3"></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">Lưu thay đổi</button>
                        <button type="button" class="btn btn-secondary" onclick="showPage('exam-list')">Quay lại</button>
                    </div>
                </form>
            </div>
        </section>

        <!-- Trang làm bài -->
        <section id="exam" class="page">
            <div class="exam-container">
                <h2 class="exam-title" id="exam-name">Đề thi Toán học - Giữa kỳ 1</h2>
                <div class="timer" id="timer">60:00</div>
                
                <div class="question">
                    <p><strong>Câu 1:</strong> Cho hàm số \( f(x) = x^2 - 4x + 3 \). Đạo hàm của hàm số tại x = 2 là:</p>
                    <div class="options">
                        <div class="option">
                            <input type="radio" name="q1" id="q1a">
                            <label for="q1a">A. 0</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q1" id="q1b">
                            <label for="q1b">B. 1</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q1" id="q1c">
                            <label for="q1c">C. 2</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q1" id="q1d">
                            <label for="q1d">D. 3</label>
                        </div>
                    </div>
                </div>
                
                <div class="question">
                    <p><strong>Câu 2:</strong> Phương trình \( x^2 - 5x + 6 = 0 \) có nghiệm là:</p>
                    <div class="options">
                        <div class="option">
                            <input type="radio" name="q2" id="q2a">
                            <label for="q2a">A. x=1 và x=6</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q2" id="q2b">
                            <label for="q2b">B. x=2 và x=3</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q2" id="q2c">
                            <label for="q2c">C. x=-2 và x=-3</label>
                        </div>
                        <div class="option">
                            <input type="radio" name="q2" id="q2d">
                            <label for="q2d">D. x=0 và x=5</label>
                        </div>
                    </div>
                </div>
                
                <div class="submit-container">
                    <a class="btn btn-primary" href="result.html">Nộp bài</a>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer>
        <p>&copy; 2025 Hệ Thống Thi Trực Tuyến. Tất cả quyền được bảo lưu.</p>
    </footer>

    <script src="js/jas.js"></script>
    
    <script>
        // Load danh sách đề thi
function loadExams() {
    fetch("exam_api.php?action=list")
        .then(res => res.json())
        .then(data => {
            const container = document.querySelector(".exams-grid");
            container.innerHTML = "";
            data.forEach(exam => {
                container.innerHTML += `
                <div class="exam-card">
                    <div class="exam-header"><h3>${exam.title}</h3></div>
                    <div class="exam-body">
                        <div class="exam-info"><span>Số câu:</span> <span>${exam.questions} câu</span></div>
                        <div class="exam-info"><span>Thời gian:</span> <span>${exam.time} phút</span></div>
                        <div class="exam-info"><span>Độ khó:</span> <span>${exam.difficulty}</span></div>
                    </div>
                    <div class="exam-footer">
                        <button class="btn btn-primary" onclick="startExam(${exam.id})">Bắt đầu thi</button>
                        <button class="btn btn-secondary" onclick="editExam(${exam.id})">Sửa</button>
                        <button class="btn btn-danger" onclick="deleteExam(${exam.id})">Xóa</button>
                    </div>
                </div>`;
            });
        });
}
window.onload = loadExams;

// Thêm đề thi
document.getElementById("add-exam-form").addEventListener("submit", function(e) {
    e.preventDefault();
    const formData = new FormData(this);
    fetch("exam_api.php?action=add", { method: "POST", body: formData })
        .then(res => res.text())
        .then(data => {
            if (data === "success") {
                alert("Thêm đề thi thành công!");
                loadExams();
                showPage('exam-list');
            }
        });
});

// Sửa đề thi: nạp dữ liệu vào form
function editExam(id) {
    fetch("exam_api.php?action=list")
        .then(res => res.json())
        .then(data => {
            const exam = data.find(e => e.id == id);
            if (!exam) return;
            document.getElementById('edit-exam-title').value = exam.title;
            document.getElementById('edit-exam-subject').value = exam.subject;
            document.getElementById('edit-exam-questions').value = exam.questions;
            document.getElementById('edit-exam-time').value = exam.time;
            document.getElementById('edit-exam-difficulty').value = exam.difficulty;
            document.getElementById('edit-exam-description').value = exam.description;
            document.getElementById('edit-exam-form').setAttribute('data-id', id);
            showPage('edit-exam');
        });
}

// Lưu sửa
document.getElementById("edit-exam-form").addEventListener("submit", function(e) {
    e.preventDefault();
    const id = this.getAttribute('data-id');
    const formData = new FormData(this);
    formData.append("id", id);

    fetch("exam_api.php?action=edit", { method: "POST", body: formData })
        .then(res => res.text())
        .then(data => {
            if (data === "success") {
                alert("Cập nhật thành công!");
                loadExams();
                showPage('exam-list');
            }
        });
});

// Xóa đề thi
function deleteExam(id) {
    if (!confirm("Bạn có chắc chắn muốn xóa đề thi này?")) return;
    const formData = new FormData();
    formData.append("id", id);
    fetch("exam_api.php?action=delete", { method: "POST", body: formData })
        .then(res => res.text())
        .then(data => {
            if (data === "success") {
                alert("Đã xóa!");
                loadExams();
            }
        });
}

    </script>
</html>